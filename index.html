<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#2563eb" />
  <title>ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø¹Ø©</title>

  <!-- Ø¶Ø¹ ØµÙˆØ±Ø© Ø§Ù„Ø´Ø¹Ø§Ø± Ø¨Ø§Ø³Ù… logo.png Ø¨Ø¬ÙˆØ§Ø± Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù -->
  <link rel="icon" type="image/png" href="logo.png" />

  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet" />

  <style>
    * { font-family: 'Tajawal', sans-serif; }
    *, *::before, *::after { box-sizing: border-box; }

    .liquid {
      transition: height 0.5s ease-out;
      border-radius: 0 0 8px 8px;
    }

    .container-vessel {
      position: relative;
      border: 4px solid #64748b;
      border-radius: 12px;
      background: linear-gradient(to bottom, #f1f5f9, #e2e8f0);
      overflow: hidden;
    }

    .bounce-btn { transition: transform 0.2s; }
    .bounce-btn:hover { transform: scale(1.05); }
    .bounce-btn:active { transform: scale(0.95); }

    .star { animation: twinkle 1s ease-in-out infinite alternate; }
    @keyframes twinkle {
      from { opacity: 0.5; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1.2); }
    }

    .shake { animation: shake 0.5s ease-in-out; }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
      50% { box-shadow: 0 0 40px rgba(59, 130, 246, 0.6); }
    }
  </style>
</head>

<body class="h-full overflow-auto bg-gradient-to-br from-sky-100 via-blue-50 to-indigo-100">
  <div id="app-wrapper" class="min-h-full w-full">

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 px-6 shadow-lg">
      <div class="max-w-4xl mx-auto">
        <div class="flex flex-col items-center text-center gap-2">
          <div class="flex items-center justify-center gap-3">
            <img
              src="logo.png"
              alt="Ø§Ù„Ø´Ø¹Ø§Ø±"
              class="w-14 h-14 rounded-2xl bg-white/10 p-1 shadow-md ring-2 ring-white/20"
              loading="lazy"
              onerror="this.style.display='none';"
            />
            <div>
              <h1 id="app-title" class="text-3xl font-bold mb-1">ğŸ¥¤ ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø¹Ø© ğŸ¥¤</h1>
              <p id="welcome-msg" class="text-blue-100 text-lg">Ù‡ÙŠØ§ Ù†ØªØ¹Ù„Ù… ÙƒÙŠÙ Ù†Ù‚ÙŠØ³ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„!</p>
            </div>
          </div>

          <div class="mt-1 text-xs text-white/75">
            Ø£/ ÙØ§Ø·Ù…Ø© Ù‡Ø²Ø§Ø²ÙŠ â€¢ Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª | Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white/90 backdrop-blur shadow-md sticky top-0 z-10">
      <div class="max-w-4xl mx-auto flex justify-center gap-2 p-3 flex-wrap">
        <button onclick="showSection('learn')" class="tab-btn bounce-btn px-5 py-2 rounded-full font-bold transition-all bg-blue-500 text-white" data-tab="learn"> ğŸ“š ØªØ¹Ù„Ù… </button>
        <button onclick="showSection('practice')" class="tab-btn bounce-btn px-5 py-2 rounded-full font-bold transition-all bg-gray-200 text-gray-700" data-tab="practice"> ğŸ® ØªØ¯Ø±Ø¨ </button>
        <button onclick="showSection('quiz')" class="tab-btn bounce-btn px-5 py-2 rounded-full font-bold transition-all bg-gray-200 text-gray-700" data-tab="quiz"> âœ¨ Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ </button>
        <button onclick="showSection('real-life')" class="tab-btn bounce-btn px-5 py-2 rounded-full font-bold transition-all bg-gray-200 text-gray-700" data-tab="real-life"> ğŸ  ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ </button>
      </div>
    </nav>

    <main class="max-w-4xl mx-auto p-4 pb-10">

      <!-- Learn Section -->
      <section id="learn-section" class="section">
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
          <h2 class="text-2xl font-bold text-blue-700 mb-4 text-center">ğŸŒŸ Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø³Ø¹Ø©ØŸ</h2>

          <div class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-5 mb-6 border-2 border-yellow-200">
            <p class="text-xl text-gray-700 leading-relaxed text-center">
              <strong class="text-orange-600">Ø§Ù„Ø³Ø¹Ø©</strong> Ù‡ÙŠ ÙƒÙ…ÙŠØ© Ø§Ù„Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ­Ù…Ù„Ù‡Ø§ Ø§Ù„Ø¥Ù†Ø§Ø¡
            </p>
          </div>

          <!-- Visual Containers -->
          <div class="grid grid-cols-3 gap-4 mb-6">
            <div class="text-center">
              <div class="container-vessel w-16 h-24 mx-auto mb-2">
                <div class="liquid bg-gradient-to-t from-blue-500 to-blue-300 w-full absolute bottom-0" style="height: 30%"></div>
              </div>
              <p class="font-bold text-blue-600">ÙƒÙˆØ¨ ØµØºÙŠØ±</p>
              <p class="text-sm text-gray-500">Ø³Ø¹Ø© Ù‚Ù„ÙŠÙ„Ø©</p>
            </div>

            <div class="text-center">
              <div class="container-vessel w-20 h-28 mx-auto mb-2">
                <div class="liquid bg-gradient-to-t from-green-500 to-green-300 w-full absolute bottom-0" style="height: 50%"></div>
              </div>
              <p class="font-bold text-green-600">Ø²Ø¬Ø§Ø¬Ø© Ù…ØªÙˆØ³Ø·Ø©</p>
              <p class="text-sm text-gray-500">Ø³Ø¹Ø© Ù…ØªÙˆØ³Ø·Ø©</p>
            </div>

            <div class="text-center">
              <div class="container-vessel w-24 h-32 mx-auto mb-2">
                <div class="liquid bg-gradient-to-t from-purple-500 to-purple-300 w-full absolute bottom-0" style="height: 70%"></div>
              </div>
              <p class="font-bold text-purple-600">Ø¥Ø¨Ø±ÙŠÙ‚ ÙƒØ¨ÙŠØ±</p>
              <p class="text-sm text-gray-500">Ø³Ø¹Ø© ÙƒØ¨ÙŠØ±Ø©</p>
            </div>
          </div>

          <!-- Units -->
          <div class="bg-blue-50 rounded-xl p-5 border-2 border-blue-200">
            <h3 class="text-xl font-bold text-blue-700 mb-3 text-center">ğŸ“ ÙˆØ­Ø¯Ø§Øª Ù‚ÙŠØ§Ø³ Ø§Ù„Ø³Ø¹Ø©</h3>

            <div class="grid grid-cols-2 gap-4">
              <div class="bg-white rounded-lg p-4 text-center shadow">
                <span class="text-4xl">ğŸ¥›</span>
                <p class="font-bold text-2xl text-blue-600 mt-2">Ø§Ù„Ù„ØªØ± (Ù„)</p>
                <p class="text-gray-600">Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„ÙƒØ¨ÙŠØ±Ø©</p>
              </div>

              <div class="bg-white rounded-lg p-4 text-center shadow">
                <span class="text-4xl">ğŸ’§</span>
                <p class="font-bold text-2xl text-green-600 mt-2">Ø§Ù„Ù…Ù„ÙŠÙ„ØªØ± (Ù…Ù„)</p>
                <p class="text-gray-600">Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„ØµØºÙŠØ±Ø©</p>
              </div>
            </div>

            <div class="mt-4 bg-yellow-100 rounded-lg p-3 text-center">
              <p class="text-lg font-bold text-yellow-800">â­ Ù¡ Ù„ØªØ± = Ù¡Ù Ù Ù  Ù…Ù„ÙŠÙ„ØªØ± â­</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Practice Section -->
      <section id="practice-section" class="section hidden">
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
          <h2 class="text-2xl font-bold text-green-700 mb-4 text-center">ğŸ® ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø£ÙˆØ§Ù†ÙŠ</h2>

          <div class="bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-6">

            <!-- Target -->
            <div class="text-center mb-4">
              <p class="text-lg text-gray-600">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¥Ù†Ø§Ø¡ Ø­ØªÙ‰:</p>
              <p id="target-display" class="text-4xl font-bold text-green-600">Ù¥Ù Ù  Ù…Ù„</p>
            </div>

            <!-- Container -->
            <div class="flex justify-center mb-4">
              <div class="relative">
                <div id="practice-container" class="container-vessel w-32 h-48 pulse-glow">
                  <div id="practice-liquid" class="liquid bg-gradient-to-t from-cyan-500 to-cyan-300 w-full absolute bottom-0" style="height: 0%"></div>

                  <!-- Measurement Lines -->
                  <div class="absolute right-1 top-0 h-full flex flex-col justify-between py-2 text-xs text-gray-500">
                    <span>Ù¡Ù Ù Ù </span>
                    <span>Ù§Ù¥Ù </span>
                    <span>Ù¥Ù Ù </span>
                    <span>Ù¢Ù¥Ù </span>
                    <span>Ù </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Current Amount -->
            <div class="text-center mb-4">
              <p class="text-2xl font-bold text-cyan-600">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: <span id="current-amount">Ù </span> Ù…Ù„</p>
            </div>

            <!-- Controls -->
            <div class="flex justify-center gap-3 flex-wrap">
              <button onclick="addWater(50)" class="bounce-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold"> +Ù¥Ù  Ù…Ù„ ğŸ’§ </button>
              <button onclick="addWater(100)" class="bounce-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold"> +Ù¡Ù Ù  Ù…Ù„ ğŸ’§ğŸ’§ </button>
              <button onclick="addWater(250)" class="bounce-btn bg-blue-700 hover:bg-blue-800 text-white px-4 py-2 rounded-lg font-bold"> +Ù¢Ù¥Ù  Ù…Ù„ ğŸ¥› </button>
              <button onclick="resetWater()" class="bounce-btn bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-bold"> Ø¥Ø¹Ø§Ø¯Ø© ğŸ”„ </button>
            </div>

            <!-- Feedback -->
            <div id="practice-feedback" class="mt-4 text-center text-xl font-bold hidden"></div>
          </div>

          <!-- New Target Button -->
          <div class="text-center mt-4">
            <button onclick="newTarget()" class="bounce-btn bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-xl font-bold text-lg"> ğŸ¯ Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯ </button>
          </div>
        </div>
      </section>

      <!-- Quiz Section -->
      <section id="quiz-section" class="section hidden">
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
          <h2 class="text-2xl font-bold text-purple-700 mb-4 text-center">âœ¨ Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ</h2>

          <!-- Score -->
          <div class="bg-purple-100 rounded-xl p-4 mb-6 text-center">
            <p class="text-xl">
              Ø§Ù„Ù†Ù‚Ø§Ø·:
              <span id="score" class="font-bold text-purple-600 text-2xl">Ù </span>
              /
              <span id="total-questions">Ù¥</span>
            </p>
            <div id="stars-container" class="flex justify-center gap-1 mt-2"></div>
          </div>

          <!-- Question -->
          <div id="quiz-container" class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6">
            <p id="question-number" class="text-sm text-purple-500 mb-2">Ø§Ù„Ø³Ø¤Ø§Ù„ Ù¡ Ù…Ù† Ù¥</p>
            <p id="question-text" class="text-xl font-bold text-gray-800 mb-6 text-center"></p>
            <div id="options-container" class="grid grid-cols-2 gap-3"></div>
          </div>

          <!-- Quiz Feedback -->
          <div id="quiz-feedback" class="mt-4 text-center hidden">
            <p id="feedback-text" class="text-xl font-bold mb-4"></p>
            <button onclick="nextQuestion()" id="next-btn" class="bounce-btn bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-xl font-bold hidden"> Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸ </button>
            <button onclick="restartQuiz()" id="restart-btn" class="bounce-btn bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl font-bold hidden"> Ø£Ø¹Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ğŸ”„ </button>
          </div>
        </div>
      </section>

      <!-- Real Life Section -->
      <section id="real-life-section" class="section hidden">
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
          <h2 class="text-2xl font-bold text-orange-700 mb-4 text-center">ğŸ  Ø§Ù„Ø³Ø¹Ø© ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>

          <div class="grid gap-4">

            <!-- Kitchen -->
            <div class="bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-5 border-2 border-orange-200">
              <h3 class="text-xl font-bold text-orange-600 mb-3">ğŸ³ ÙÙŠ Ø§Ù„Ù…Ø·Ø¨Ø®</h3>
              <div class="grid grid-cols-2 gap-3">
                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ¥„</span>
                  <p class="font-bold text-gray-700">Ù…Ù„Ø¹Ù‚Ø© ØµØºÙŠØ±Ø©</p>
                  <p class="text-orange-600 font-bold">Ù¥ Ù…Ù„</p>
                </div>

                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ¥£</span>
                  <p class="font-bold text-gray-700">ÙƒÙˆØ¨ Ø§Ù„Ø·Ø¨Ø®</p>
                  <p class="text-orange-600 font-bold">Ù¢Ù¥Ù  Ù…Ù„</p>
                </div>
              </div>
            </div>

            <!-- Drinks -->
            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-5 border-2 border-blue-200">
              <h3 class="text-xl font-bold text-blue-600 mb-3">ğŸ¥¤ Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª</h3>
              <div class="grid grid-cols-3 gap-3">
                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ§ƒ</span>
                  <p class="font-bold text-gray-700 text-sm">Ø¹Ù„Ø¨Ø© Ø¹ØµÙŠØ±</p>
                  <p class="text-blue-600 font-bold">Ù¢Ù Ù  Ù…Ù„</p>
                </div>

                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ¼</span>
                  <p class="font-bold text-gray-700 text-sm">Ø²Ø¬Ø§Ø¬Ø© Ù…Ø§Ø¡ ØµØºÙŠØ±Ø©</p>
                  <p class="text-blue-600 font-bold">Ù¥Ù Ù  Ù…Ù„</p>
                </div>

                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ«—</span>
                  <p class="font-bold text-gray-700 text-sm">Ø²Ø¬Ø§Ø¬Ø© Ù…Ø§Ø¡ ÙƒØ¨ÙŠØ±Ø©</p>
                  <p class="text-blue-600 font-bold">Ù¡ Ù„ØªØ±</p>
                </div>
              </div>
            </div>

            <!-- Home -->
            <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-5 border-2 border-green-200">
              <h3 class="text-xl font-bold text-green-600 mb-3">ğŸ¡ ÙÙŠ Ø§Ù„Ø¨ÙŠØª</h3>
              <div class="grid grid-cols-2 gap-3">
                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸª£</span>
                  <p class="font-bold text-gray-700">Ø¯Ù„Ùˆ Ø§Ù„ØªÙ†Ø¸ÙŠÙ</p>
                  <p class="text-green-600 font-bold">Ù¡Ù  Ù„ØªØ±</p>
                </div>

                <div class="bg-white rounded-lg p-3 text-center shadow">
                  <span class="text-3xl">ğŸ›</span>
                  <p class="font-bold text-gray-700">Ø­ÙˆØ¶ Ø§Ù„Ø§Ø³ØªØ­Ù…Ø§Ù…</p>
                  <p class="text-green-600 font-bold">Ù¡Ù¥Ù  Ù„ØªØ±</p>
                </div>
              </div>
            </div>

            <!-- Challenge -->
            <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-5 border-2 border-purple-300">
              <h3 class="text-xl font-bold text-purple-700 mb-3 text-center">ğŸ¤” ØªØ­Ø¯ÙŠ Ù„Ù„ØªÙÙƒÙŠØ±</h3>
              <p class="text-gray-700 text-center text-lg mb-4">
                Ø¥Ø°Ø§ Ø´Ø±Ø¨Øª Ù¤ Ø£ÙƒÙˆØ§Ø¨ Ù…Ø§Ø¡ ÙŠÙˆÙ…ÙŠØ§Ù‹ØŒ ÙˆÙƒÙ„ ÙƒÙˆØ¨ Ø³Ø¹ØªÙ‡ Ù¢Ù¥Ù  Ù…Ù„ØŒ ÙƒÙ… Ù„ØªØ±Ø§Ù‹ ØªØ´Ø±Ø¨ØŸ
              </p>

              <div id="challenge-answer" class="hidden bg-white rounded-lg p-4 text-center">
                <p class="text-green-600 font-bold text-xl">Ù¤ Ã— Ù¢Ù¥Ù  = Ù¡Ù Ù Ù  Ù…Ù„ = Ù¡ Ù„ØªØ±! ğŸ‰</p>
              </div>

              <button onclick="showChallengeAnswer()" id="show-answer-btn" class="bounce-btn w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-bold mt-2"> Ø§ÙƒØ´Ù Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ğŸ‘€ </button>
            </div>
          </div>
        </div>
      </section>

    </main>

    <!-- Footer (Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù…Ø¹ØªØ§Ø¯) -->
    <footer class="bg-gradient-to-r from-slate-900 to-slate-800 text-white">
      <div class="max-w-4xl mx-auto px-4 py-6">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">

          <div class="flex items-center gap-3">
            <img
              src="logo.png"
              alt="Ø§Ù„Ø´Ø¹Ø§Ø±"
              class="w-12 h-12 rounded-xl bg-white/10 p-1 ring-1 ring-white/15"
              loading="lazy"
              onerror="this.style.display='none';"
            />
            <div class="text-center md:text-right">
              <p class="font-extrabold text-lg">Ø£/ ÙØ§Ø·Ù…Ø© Ù‡Ø²Ø§Ø²ÙŠ</p>
              <p class="text-sm text-white/75">Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª | Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</p>
            </div>
          </div>

          <div class="text-center md:text-left">
            <p class="text-white/90 font-bold">ğŸŒŸ ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø¹Ø© Ø¨Ù…ØªØ¹Ø©! ğŸŒŸ</p>
            <p class="text-sm text-white/60 mt-1">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© <span id="year"></span></p>
          </div>

        </div>
      </div>
    </footer>

  </div>

  <script>
    // Default configuration
    const defaultConfig = {
      app_title: 'ğŸ¥¤ ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø¹Ø© ğŸ¥¤',
      welcome_message: 'Ù‡ÙŠØ§ Ù†ØªØ¹Ù„Ù… ÙƒÙŠÙ Ù†Ù‚ÙŠØ³ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„!',
      primary_color: '#2563eb',
      secondary_color: '#ffffff',
      text_color: '#1f2937',
      accent_color: '#10b981',
      background_color: '#e0f2fe'
    };

    // State
    let currentAmount = 0;
    let targetAmount = 500;
    let score = 0;
    let currentQuestion = 0;
    let questions = [];

    // Quiz questions
    const allQuestions = [
      { question: 'Ù…Ø§ ÙˆØ­Ø¯Ø© Ù‚ÙŠØ§Ø³ Ø§Ù„Ø³Ø¹Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©ØŸ', options: ['Ø§Ù„Ù„ØªØ±', 'Ø§Ù„Ù…ØªØ±', 'Ø§Ù„ÙƒÙŠÙ„Ùˆ', 'Ø§Ù„Ø³Ù†ØªÙŠÙ…ØªØ±'], correct: 0 },
      { question: 'ÙƒÙ… Ù…Ù„ÙŠÙ„ØªØ± ÙÙŠ Ø§Ù„Ù„ØªØ± Ø§Ù„ÙˆØ§Ø­Ø¯ØŸ', options: ['Ù¡Ù Ù ', 'Ù¥Ù Ù ', 'Ù¡Ù Ù Ù ', 'Ù¡Ù Ù Ù Ù '], correct: 2 },
      { question: 'Ø£ÙŠ Ø¥Ù†Ø§Ø¡ Ø³Ø¹ØªÙ‡ Ø£ÙƒØ¨Ø±ØŸ', options: ['ÙƒÙˆØ¨ Ø´Ø§ÙŠ', 'Ø¥Ø¨Ø±ÙŠÙ‚ Ù…Ø§Ø¡', 'Ù…Ù„Ø¹Ù‚Ø©', 'Ø¹Ù„Ø¨Ø© Ø¹ØµÙŠØ±'], correct: 1 },
      { question: 'Ø²Ø¬Ø§Ø¬Ø© Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„ØµØºÙŠØ±Ø© Ø³Ø¹ØªÙ‡Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹:', options: ['Ù¥Ù  Ù…Ù„', 'Ù¥Ù Ù  Ù…Ù„', 'Ù¥ Ù„ØªØ±', 'Ù¥Ù  Ù„ØªØ±'], correct: 1 },
      { question: 'Ù…Ø§Ø°Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ Ø§Ù„ØµØºÙŠØ±Ø©ØŸ', options: ['Ø§Ù„Ù„ØªØ±', 'Ø§Ù„Ù…Ù„ÙŠÙ„ØªØ±', 'Ø§Ù„ÙƒÙŠÙ„ÙˆÙ…ØªØ±', 'Ø§Ù„Ø¬Ø±Ø§Ù…'], correct: 1 },
      { question: 'Ù¢ Ù„ØªØ± = ÙƒÙ… Ù…Ù„ÙŠÙ„ØªØ±ØŸ', options: ['Ù¢Ù Ù ', 'Ù¢Ù Ù Ù ', 'Ù¢Ù ', 'Ù¢Ù Ù Ù Ù '], correct: 1 },
      { question: 'Ø¹Ù„Ø¨Ø© Ø§Ù„Ø¹ØµÙŠØ± Ø§Ù„ØµØºÙŠØ±Ø© Ø³Ø¹ØªÙ‡Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹:', options: ['Ù¢ Ù„ØªØ±', 'Ù¢Ù Ù  Ù…Ù„', 'Ù¢Ù  Ù„ØªØ±', 'Ù¢Ù  Ù…Ù„'], correct: 1 },
      { question: 'Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ù„ÙŠØ³Øª ÙˆØ­Ø¯Ø© Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ø³Ø¹Ø©ØŸ', options: ['Ø§Ù„Ù„ØªØ±', 'Ø§Ù„Ù…Ù„ÙŠÙ„ØªØ±', 'Ø§Ù„ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…', 'Ø¬Ù…ÙŠØ¹Ù‡Ø§ ÙˆØ­Ø¯Ø§Øª Ø³Ø¹Ø©'], correct: 2 }
    ];

    // Convert number to Arabic
    function toArabicNum(num) {
      const arabicNums = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
      return num.toString().split('').map(d => arabicNums[parseInt(d)] || d).join('');
    }

    // Show section
    function showSection(sectionName) {
      document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
      document.getElementById(sectionName + '-section').classList.remove('hidden');

      document.querySelectorAll('.tab-btn').forEach(btn => {
        if (btn.dataset.tab === sectionName) {
          btn.classList.remove('bg-gray-200', 'text-gray-700');
          btn.classList.add('bg-blue-500', 'text-white');
        } else {
          btn.classList.remove('bg-blue-500', 'text-white');
          btn.classList.add('bg-gray-200', 'text-gray-700');
        }
      });
    }

    // Practice functions
    function addWater(amount) {
      if (currentAmount + amount <= 1000) {
        currentAmount += amount;
        updateWaterDisplay();
        checkTarget();
      } else {
        const container = document.getElementById('practice-container');
        container.classList.add('shake');
        setTimeout(() => container.classList.remove('shake'), 500);
      }
    }

    function resetWater() {
      currentAmount = 0;
      updateWaterDisplay();
      document.getElementById('practice-feedback').classList.add('hidden');
    }

    function updateWaterDisplay() {
      const liquid = document.getElementById('practice-liquid');
      const display = document.getElementById('current-amount');
      const percentage = (currentAmount / 1000) * 100;
      liquid.style.height = percentage + '%';
      display.textContent = toArabicNum(currentAmount);
    }

    function checkTarget() {
      const feedback = document.getElementById('practice-feedback');
      feedback.classList.remove('hidden');

      if (currentAmount === targetAmount) {
        feedback.innerHTML = '<span class="text-green-600">ğŸ‰ Ø£Ø­Ø³Ù†Øª! ÙˆØµÙ„Øª Ù„Ù„Ù‡Ø¯Ù!</span>';
      } else if (currentAmount > targetAmount) {
        feedback.innerHTML = '<span class="text-red-600">ğŸ˜… Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù…! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</span>';
      } else {
        feedback.innerHTML = '<span class="text-blue-600">ğŸ‘ Ø§Ø³ØªÙ…Ø±! Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯</span>';
      }
    }

    function newTarget() {
      const targets = [100,150,200,250,300,350,400,450,500,600,700,750,800,900,1000];
      targetAmount = targets[Math.floor(Math.random() * targets.length)];
      document.getElementById('target-display').textContent = toArabicNum(targetAmount) + ' Ù…Ù„';
      resetWater();
    }

    // Quiz functions
    function initQuiz() {
      const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
      questions = shuffled.slice(0, 5);
      score = 0;
      currentQuestion = 0;
      document.getElementById('score').textContent = toArabicNum(score);
      document.getElementById('stars-container').innerHTML = '';
      showQuestion();
    }

    function showQuestion() {
      const q = questions[currentQuestion];
      document.getElementById('question-number').textContent =
        `Ø§Ù„Ø³Ø¤Ø§Ù„ ${toArabicNum(currentQuestion + 1)} Ù…Ù† ${toArabicNum(questions.length)}`;
      document.getElementById('question-text').textContent = q.question;

      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = '';

      q.options.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'bounce-btn bg-white border-2 border-purple-300 hover:border-purple-500 p-4 rounded-xl font-bold text-gray-700 transition-all';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index);
        optionsContainer.appendChild(btn);
      });

      document.getElementById('quiz-feedback').classList.add('hidden');
      document.getElementById('next-btn').classList.add('hidden');
      document.getElementById('restart-btn').classList.add('hidden');
    }

    function checkAnswer(selected) {
      const q = questions[currentQuestion];
      const feedback = document.getElementById('quiz-feedback');
      const feedbackText = document.getElementById('feedback-text');
      const options = document.querySelectorAll('#options-container button');

      options.forEach((btn, i) => {
        btn.disabled = true;
        if (i === q.correct) {
          btn.classList.add('bg-green-500', 'text-white', 'border-green-500');
        } else if (i === selected && i !== q.correct) {
          btn.classList.add('bg-red-500', 'text-white', 'border-red-500');
        }
      });

      feedback.classList.remove('hidden');

      if (selected === q.correct) {
        score++;
        document.getElementById('score').textContent = toArabicNum(score);
        feedbackText.innerHTML = '<span class="text-green-600">ğŸ‰ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</span>';
        addStar();
      } else {
        feedbackText.innerHTML = '<span class="text-red-600">ğŸ˜” Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©</span>';
      }

      if (currentQuestion < questions.length - 1) {
        document.getElementById('next-btn').classList.remove('hidden');
      } else {
        showFinalScore();
      }
    }

    function addStar() {
      const container = document.getElementById('stars-container');
      const star = document.createElement('span');
      star.className = 'star text-2xl';
      star.textContent = 'â­';
      container.appendChild(star);
    }

    function nextQuestion() {
      currentQuestion++;
      showQuestion();
    }

    function showFinalScore() {
      const feedbackText = document.getElementById('feedback-text');
      const percentage = (score / questions.length) * 100;

      let message = '';
      if (percentage === 100) message = 'ğŸ† Ù…Ù…ØªØ§Ø²! Ø£Ù†Øª Ù†Ø¬Ù…! ğŸŒŸ';
      else if (percentage >= 80) message = 'ğŸ‰ Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ø§Ù‹!';
      else if (percentage >= 60) message = 'ğŸ‘ Ø¬ÙŠØ¯! ÙˆØ§ØµÙ„ Ø§Ù„ØªØ¹Ù„Ù…';
      else message = 'ğŸ’ª Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!';

      feedbackText.innerHTML = `<span class="text-purple-600">${message}<br>Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${toArabicNum(score)} Ù…Ù† ${toArabicNum(questions.length)}</span>`;
      document.getElementById('restart-btn').classList.remove('hidden');
    }

    function restartQuiz() { initQuiz(); }

    // Real life section
    function showChallengeAnswer() {
      document.getElementById('challenge-answer').classList.remove('hidden');
      document.getElementById('show-answer-btn').classList.add('hidden');
    }

    // Config change handler (Ø¥Ù† ÙˆØ¬Ø¯ elementSdk)
    async function onConfigChange(config) {
      const titleEl = document.getElementById('app-title');
      const welcomeEl = document.getElementById('welcome-msg');

      if (titleEl) titleEl.textContent = config.app_title || defaultConfig.app_title;
      if (welcomeEl) welcomeEl.textContent = config.welcome_message || defaultConfig.welcome_message;

      document.body.parentElement.style.setProperty('--primary-color', config.primary_color || defaultConfig.primary_color);
      document.body.parentElement.style.setProperty('--text-color', config.text_color || defaultConfig.text_color);
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          { get: () => config.background_color || defaultConfig.background_color, set: (value) => { config.background_color = value; window.elementSdk?.setConfig?.({ background_color: value }); } },
          { get: () => config.secondary_color || defaultConfig.secondary_color, set: (value) => { config.secondary_color = value; window.elementSdk?.setConfig?.({ secondary_color: value }); } },
          { get: () => config.text_color || defaultConfig.text_color, set: (value) => { config.text_color = value; window.elementSdk?.setConfig?.({ text_color: value }); } },
          { get: () => config.primary_color || defaultConfig.primary_color, set: (value) => { config.primary_color = value; window.elementSdk?.setConfig?.({ primary_color: value }); } },
          { get: () => config.accent_color || defaultConfig.accent_color, set: (value) => { config.accent_color = value; window.elementSdk?.setConfig?.({ accent_color: value }); } }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['app_title', config.app_title || defaultConfig.app_title],
        ['welcome_message', config.welcome_message || defaultConfig.welcome_message]
      ]);
    }

    if (window.elementSdk?.init) {
      window.elementSdk.init({ defaultConfig, onConfigChange, mapToCapabilities, mapToEditPanelValues });
    }

    // Initialize quiz on load
    initQuiz();

    // Year in footer (Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)
    const yearEl = document.getElementById('year');
    if (yearEl) yearEl.textContent = toArabicNum(new Date().getFullYear());
  </script>
</body>
</html>
